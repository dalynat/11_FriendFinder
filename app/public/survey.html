<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />
    <script type = 'text/javascript' src='../routing//apiRoutes.js'></script>
    <script type = 'text/javascript' src='../data/friends.js'></script>
    <title>Document</title>
</head>
<body>
    <div class='jumbotron'>
        <div >
            <h1>Survey!</h1>
            <hr/`>
            <h3>Your Name:</h3>
            <input 

            type= 'text' 
            id ='name' 
            class='form-inputs'
            required
            />
            <br/>
            <h3>Link to a Photo of Yourself:</h3>
            <input 

            type= 'text' 
            id ='photo' 
            class='form-inputs'
            required
            />
        </div>
        <div>
            <h3>Question 1</h3>
            <h5>Do you like pina coladas?</h5>
            <select class ="chosen-select" id='Q1'>
                <option value=''></option>
                <option value='5'>5 (Yes %100)</option>
                <option value='4'>4</option>
                <option value='3'>3</option>
                <option value='2'>2</option>
                <option value='1'>1 (ehhhh)</option>
            </select>
            <br/>

            <h3>Question 2</h3>
            <h5>Pineapple on pizza?</h5>
            <select class ="chosen-select" id='Q2'>
                <option value=''></option>
                <option value='5'>5 (Yes %100)</option>
                <option value='4'>4</option>
                <option value='3'>3</option>
                <option value='2'>2</option>
                <option value='1'>1 (ehhhh)</option>
            </select>
            <br/>

            <h3>Question 3</h3>
            <h5>Do you like sports?</h5>
            <select class ="chosen-select" id='Q3'>
                <option value=''></option>
                <option value='5'>5 (Yes %100)</option>
                <option value='4'>4</option>
                <option value='3'>3</option>
                <option value='2'>2</option>
                <option value='1'>1 (ehhhh)</option>
            </select>
            <br/>

            <h3>Question 4</h3>
            <h5>Do you binge watch Netflix?</h5>
            <select class ="chosen-select" id='Q4'>
                <option value=''></option>
                <option value='5'>5 (Yes %100)</option>
                <option value='4'>4</option>
                <option value='3'>3</option>
                <option value='2'>2</option>
                <option value='1'>1 (ehhhh)</option>
            </select>
            <br/>

            <h3>Question 5</h3>
            <h5>Are you a night owl (do you like to stay up late)?</h5>
            <select class ="chosen-select" id='Q5'>
                <option value=''></option>
                <option value='5'>5 (Yes %100)</option>
                <option value='4'>4</option>
                <option value='3'>3</option>
                <option value='2'>2</option>
                <option value='1'>1 (ehhhh)</option>
            </select>
            <br/>

            <h3>Question 6</h3>
            <h5>Do you prefer Summer over Winter?</h6>
            <select class ="chosen-select" id='Q6'>
                <option value=''></option>
                <option value='5'>5 (Yes %100)</option>
                <option value='4'>4</option>
                <option value='3'>3</option>
                <option value='2'>2</option>
                <option value='1'>1 (ehhhh)</option>
            </select>
            <br/>

            <h3>Question 7</h3>
            <h5>Do you watch Game of Thrones?</h5>
            <select class ="chosen-select" id='Q7'>
                <option value=''></option>
                <option value='5'>5 (Yes %100)</option>
                <option value='4'>4</option>
                <option value='3'>3</option>
                <option value='2'>2</option>
                <option value='1'>1 (ehhhh)</option>
            </select>
            <br/>

            <h3>Question 8</h3>
            <h5>You prefer to stay at home over going out to the bar</h5>
            <select class ="chosen-select" id='Q8'>
                <option value=''></option>
                <option value='5'>5 (Yes %100)</option>
                <option value='4'>4</option>
                <option value='3'>3</option>
                <option value='2'>2</option>
                <option value='1'>1 (ehhhh)</option>
            </select>
            <br/>

            <h3>Question 9</h3>
            <h5>You go out with friends often</h5>
            <select class ="chosen-select" id='Q9'>
                <option value=''></option>
                <option value='5'>5 (Yes %100)</option>
                <option value='4'>4</option>
                <option value='3'>3</option>
                <option value='2'>2</option>
                <option value='1'>1 (ehhhh)</option>
            </select>
            <br/>

            <h3>Question 10</h3>
            <h5>Do you like pickles?</h5>
            <select class ="chosen-select" id='Q10'>
                <option value=''></option>
                <option value='5'>5 (Yes %100)</option>
                <option value='4'>4</option>
                <option value='3'>3</option>
                <option value='2'>2</option>
                <option value='1'>1 (ehhhh)</option>
            </select>
            <br/>
            <button type ='submit' class ='btn btn-danger' id='submit'>Submit</button>
        </div>
    </div>
        <div id="friend-modal" class="modal" role="dialog" tabindex='-1'>
            <div class="modal-dialog" role = 'document'>

                <div class="modal-content"> 
                    <div class="modal-header">
                        <h2 class="modal-title">Your New Friend!</h2>
                        <button type='button' class="close" data-dismiss="modal" aria-label='Close'>
                            <span aria-hidden='true'>&times;</span>
                        </button>
                    </div>
                    <div class ='modal-body'>
                        <h2 id='friend-name'></h2>
                        <img class='img-responsive' style='max-height:250px'contain' id='friend-pic' alt=''>
                    </div>
                    <div class="modal-footer">
                        <button type='button' class="btn btn-danger" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    <script type="text/javascript">
    var config = {
      ".chosen-select": {},
      ".chosen-select-deselect": {
        allow_single_deselect: true
      },
      ".chosen-select-no-single": {
        disable_search_threshold: 10
      },
      ".chosen-select-no-results": {
        no_results_text: "Oops, nothing found!"
      },
      ".chosen-select-width": {
        width: "95%"
      }
    };
    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }
// When submit button is clicked, we check if the form is completed
    $('#submit').on('click', function(event){
        event.preventDefault();
        function validateForm(){
            var isValid =true;
            $('.form-inputs').each(function(){
// If name or picture are empty, set isValid to false
                if($(this).val() === ''){
                    isValid =false;
                }
            });
// If any of the questions are left unanswered, set isValid to false
            $('.chosen-select').each(function(){
                if($(this).val() === ''){
                    isValid =false;
                }
            });
            return isValid;
        }
// If form is valid, Grab all the data 
        if(validateForm()){
            var userInfo ={
                name: $('#name').val(),
                photo: $('#photo').val(),
                scores: [
                    $('#Q1').val(),
                    $('#Q2').val(),
                    $('#Q3').val(),
                    $('#Q4').val(),
                    $('#Q5').val(),
                    $('#Q6').val(),
                    $('#Q7').val(),
                    $('#Q8').val(),
                    $('#Q9').val(),
                    $('#Q10').val()
                ]
            };
            $.post('/api/friends', userInfo, function(data){
                $('#friend-name').text(data.name);
                $('#friend-pic').attr('src', data.photo);
                $('#friend-modal').modal('toggle');
            });
        }else{
            alert("Form Unfinished")
        }
    });
    </script>
</body>
</html>